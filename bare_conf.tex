% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. IEEE's font choices can trigger bugs that do  ***
% *** not appear when using other class files.                            ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/

\newcommand{\todo}[1]{\textbf{TODO: #1}}

\documentclass[conference]{IEEEtran}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

\begin{document}
\title{Spreadsheets are Code}

\author{\IEEEauthorblockN{Felienne Hermans, Bas Jansen, Sohon Roy, Efthimia Aivaloglou, David Hoepelman and Alaaeddin Swidan}
\IEEEauthorblockA{f.f.j.hermans, \todo{emailadresses}}
\IEEEauthorblockA{Delft University of Technology, the Netherlands}
}


\maketitle

\begin{abstract}
The abstract goes here.
\end{abstract}

\IEEEpeerreviewmaketitle

\section{Introduction}
Spreadsheets are used for a large variety of different tasks, from invoicing to planning and from budgeting to scheduling, in all sorts of domains, from small shops to multinationals. In 2004, the International Data Corporation interview 118 business leaders and found that 85\% were using spreadsheets in financial reporting and forecasting~\cite{Panko2008} Especially in the financial domain, spreadsheets are ubiquitous. Financial intelligence firm CODA reported in 2008 that 95\% of all U.S. companies use spreadsheets for financial reporting~\cite{Panko2008}. The number of end-user programmers in the USA alone is conservatively estimated at 11 million, compared to only 2.75 million other, professional programmers~\cite{Scaf2005}. 

As artifacts of end-user programming, spreadsheets often play a role similar to source code in many companies: they support important organizational processes and sometimes even business decisions are taken based on the information they contain~\cite{Hermans2011}.

While spreadsheets are commonly used, their users often have little training as programmers, but in spite of that, they often face many of the challenges of professional developers, choosing which APIs, libraries, and functions to use~\cite{Ko2004}, or understanding someone else's code~\cite{Ko2011}. Since spreadsheets frequently contain errors~\cite{Panko1998}, end-users test, verify and debug their programs~\cite{Hermans2013-Cascon,Ko2004-Why}.

The above issues occurring in spreadsheets: program construction, maintenance, testing, debugging clearly occur in regular code bases too, and as such have been topics of research in the programming and software engineering community for decades.\todo{references here}. Given these similarities between spreadsheets and source code, both in terms of application and issues, it is feasible to transform methods, tools and techniques from software engineering to spreadsheets, albeit sometimes in a form more tailored towards end-users. This has exactly been the approach of a number of researchers over the last decade, and this paper highlights their past achievements, challenges and future research directions. 


\section{Background \& Motivation}
Simply put, spreadsheets are the world's most successful programming platform in the history of computing. Every day spreadsheets enable millions of business users to do reporting, planning, scheduling and all else needed to succeed in their jobs. 

Of course, there are plenty of spreadsheets that simply used to keep lists or for throw away calculations, but just as many are used for business critical calculations.

Since spreadsheets are source code, they suffer from typical software programs: they can have a long lifespan during which they are used and maintained by multiple users, they often do not have documentation and they are often riddled with errors. These problems are not unfamiliar to the software engineering community, in fact these are problems commonly addressed in our research. 



\section{Achievements} 
The core approach of the \emph{end-user software engineering} research applied to spreadsheets over the past decade has been to apply methods from software engineering to spreadsheets, addressing problems also commonly found in software in similar ways, but tailored towards the specific challenges of end-users and their artifacts.

\subsection{Testing}
\todo{summarize WYSIWYT}

\subsection{Documentation extraction} 
Like software, spreadsheets often suffer from a lack of documentation. In a field study, we found that only one in three spreadsheets have documentation~\cite{Hermans2011}. This seems to be a problem especially in situation where a spreadsheet was transferred: between colleagues, from a spreadsheet user to IT for migration or when a spreadsheet had to be reviewed by an auditor. To address the lack of documentation, we developed approaches to reverse engineers spreadsheets.

\subsubsection{Class diagrams}
\todo{Sohon?}

\subsubsection{Dataflow visualization}
\todo{Sohon?}

\subsection{Smell Detection} 
After focusing on extraction of documentation, we found out that spreadsheet users often prefer to work in spreadsheets over migrating them, hence we shifted our focus to helping users understand the complexity of spreadsheets and determine ways to improve them. For this, we took the idea of \emph{code smells} as inspiration, adapting it however, to be applicable to spreadsheets.

\subsubsection{Formula-level Smell detection}
We started by defining smells on the formula level where we found that many smell defined for code also applied nicely to spreadsheets. For example, conditional complexity can be applied as is, since spreadsheets support conditionals too. Some other smells needed some modification: many parameters became many references and long method became many operations. After defining the 

\subsubsection{Structural Smell detection}

\subsection{Clone detection}

\subsection{Improving/re-engineering/Refactoring}


\subsection{Conclusion}
This all has to do with understanding and improving quality we still want to support understanding domain/calculation.Our work and that of others was all 100\% automated, what we have learned, if we want to continue with reverse engineering, we need more support from the user, both the creator and human level intelligence (a generic user): we both want to do large studies with generic users like the labeling game and make support for users to add more (domain) knowledge to the sheets.

\section{Challenges} 

\subsection{End-users self perception}
One of the core challenges of researching spreadsheets, and also end-user programming in general is that users do not seen themselves as programmers. Therefore, they often do not have training, but this is not the core issue. We could provide them with training, but preferably we support them with easier and less error-prone methods with more expressive power to do their jobs.
The perception of end-user programmers as not being programmers is not limited to how programmers view themselves, but also to how they are seen by others. Professional developers and other coworkers of them often fail to recognize and often belittle their programming efforts.

\subsection{Lack of best practices}
A challenge that follows the previous one is the lack of standards. This inhibits easy processing of spreadsheets as it results in many differnt types of spreadsheets.

\subsection{Lack of data}
Spreadsheets often contain models and calculations of vital information to companies. As such, companies are often reluctant to share them with researchers. \todo{this is a broader issue in very applied/industrial research, tradeoff realism vs. reproducability} Even when we get large sets (like Enron), we do not have the users with them. There is no process data (version control history, like “MSR type papers”).

\subsection{Size of spreadsheets }
Spreadsheets can get big, navigating on 1 worksheet is still ok, but for larger sheets it is hard to filter what to present, just showing all dependencies is too much. [example from Enron, Sohon might have a pic]

For useful visualizatin, we have to leave the cell level, want to look at the computation level (slicing)

\todo{not sure what was meant here:}Getting domain knowledge out at a higher level, maybe with some assistance from the user, letting them know which cells have labels and which lack them.

\subsection{Performance}
Connection with size, \todo{Alaaeddin}

\subsection{Technical issues}
Finally, there are technical issues in processing spreadsheets and developing add-ins for a proprietary product like Microsoft Excel. 
Lack of open standards, and even when open, not very standardized (we have to reverse engineer stuff, link SCAM, also HPC/HEAT is not open, not willing to share)
Limited options for customization (undo/redo stack is not available, in the object model precedents do not go deeper than 1 level, objects model gets extended but not updated)

Obviously, one could steer away from these issues by implementing a system themselves (Forms/3 and Sestoft) or to build plugins for open source tools. Here however the tradeoff with realism is apparent too, building tools for Excel which is the number 1 spreadsheet solution increase the realism and impact of research tools.

\section{Future opportunities}
Given the above achievements  and challenges, we identify the following viable directions for future work.

\subsection{Continuation of the refactoring and testing work}
In contrast to the work on smells that have been tried in practice and spurred numerous follow up works and has been picked up by a larger research community, refactorings and testing need to be made more applicable.

\subsection{More deeply understanding the role of spreadsheets in the enterprise}
This understanding will have to happen both culturally (evolution, process) and in their application (use of spreadsheets) For example, classification different types of spreadsheets, potentially. For this we are exploring the following concrete endeavours:

\subsubsection{For the purpose of reverse engineering (Sohon)}
Potential application of extraction high level structure would be:
\paragraph{documentation extraction}
\paragraph{validating spreadsheets at a higher level}

\subsubsection{To support users in creating better spreadsheets}
Using  an alternative interface for some types of spreadsheets, bringing a higher level of abstraction (Bas)

\subsection{Beyond formulas}

  Self-service BI. This field is now mainly concerned with building but not with maintenance. We see them making the same mistake by not focusing on end-user maintenance, maybe underestimating the longevity of the new artifacts created. We suspect that this new incarnation of end-user programming again will suffer from smells etc. So our research will explore this, for example by focusing. Other spreadsheet concepts like PivotTables and VBA code
  

Increasing performance of spreadsheets (Allaeddin)
Intertwining of formulas and other constructs makes automated analysis even harder



\section{Conclusion}







% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}


\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
\bibliography{references}


% that's all folks
\end{document}


